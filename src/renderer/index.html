<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PDF Outline Editor</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="app">
      <header class="app-header">
        <div class="app-title">
          PDF Outline Editor <span class="version" id="appVersion"></span>
          <span class="file-name" id="fileName"></span>
        </div>
        <div class="header-actions">
          <button class="ghost" id="openPdf" title="Open PDF (‚åòO)">
            <span>üìÇ</span>
            <span>Open</span>
          </button>
          <button class="ghost" id="savePdf" title="Save PDF (‚åòS)">
            <span>üíæ</span>
            <span>Save</span>
          </button>
          <button class="ghost" id="savePdfAs" title="Save PDF As (‚åò‚áßS)">
            <span>üìÑ</span>
            <span>Save As</span>
          </button>
          <button class="ghost" id="openSettings" title="LLM Settings">
            <span>‚öôÔ∏è</span>
            <span>Settings</span>
          </button>
        </div>
      </header>
      <div class="unified-toolbar">
        <div class="toolbar-group">
          <button class="icon" id="addTitle" title="Add title (‚åòT)">‚ûï</button>
          <button class="icon" id="addChild" title="Add nested title (‚åò‚áßT)">‚Ü≥</button>
        </div>
        <div class="toolbar-separator"></div>
        <div class="toolbar-group">
          <button class="icon" id="renameTitle" title="Rename (F2 or Enter)">‚úèÔ∏è</button>
          <button class="icon" id="setPage" title="Edit target page (‚åòE)">üìç</button>
          <button class="icon" id="deleteTitle" title="Delete (Del)">üóëÔ∏è</button>
        </div>
        <div class="toolbar-separator"></div>
        <div class="toolbar-group">
          <button class="icon" id="outdentTitle" title="Decrease level (‚åò‚Üê)">‚¨ÖÔ∏è</button>
          <button class="icon" id="indentTitle" title="Increase level (‚åò‚Üí)">‚û°Ô∏è</button>
          <button class="icon" id="moveUp" title="Move up (‚åò‚Üë)">‚¨ÜÔ∏è</button>
          <button class="icon" id="moveDown" title="Move down (‚åò‚Üì)">‚¨áÔ∏è</button>
        </div>
        <div class="toolbar-separator"></div>
        <div class="toolbar-group">
          <button class="icon" id="expandAll" title="Expand all">‚äû</button>
          <button class="icon" id="collapseAll" title="Collapse all">‚äü</button>
          <button class="icon" id="undo" title="Nothing to undo (‚åòZ)" disabled>‚Ü∂</button>
          <button class="icon" id="redo" title="Nothing to redo (‚åòY)" disabled>‚Ü∑</button>
        </div>
        <div class="toolbar-separator"></div>
        <div class="toolbar-group">
          <button class="icon" id="importToc" title="Import Table of Contents">üìë</button>
        </div>
        <div class="toolbar-spacer"></div>
        <div class="toolbar-group">
          <button class="icon" id="prevPage" title="Previous page">‚óÄ</button>
          <div class="page-indicator">
            Page <input id="currentPageInput" type="text" value="1" aria-label="Current page" /> / <span id="totalPages">1</span>
          </div>
          <button class="icon" id="nextPage" title="Next page">‚ñ∂</button>
        </div>
        <div class="toolbar-separator"></div>
        <div class="toolbar-group">
          <button class="icon" id="fitWidth" title="Fit to width">‚¨å</button>
          <label class="zoom-control" title="Zoom">
            üîç
            <input id="zoomSlider" type="range" min="50" max="200" value="110" />
          </label>
        </div>
      </div>
      <div class="content">
        <aside class="outline-pane" id="outlinePane">
          <div class="outline-list" id="outlineList">
            <div class="empty-state">
              Open a PDF to start building an outline.
            </div>
          </div>
        </aside>
        <div class="divider" id="divider"></div>
        <main class="viewer-pane">
          <div class="viewer" id="viewer"></div>
          <div class="drop-zone" id="dropZone">
            Drag a PDF here or click Open to begin.
          </div>
        </main>
      </div>
    </div>
    <div class="context-menu" id="contextMenu">
      <button data-action="add">Add title</button>
      <button data-action="addChild">Add nested title</button>
      <button data-action="rename">Rename</button>
      <button data-action="setPage">Edit target page...</button>
      <button data-action="delete">Delete</button>
      <hr />
      <button data-action="outdent">Decrease level</button>
      <button data-action="indent">Increase level</button>
      <button data-action="moveUp">Move up</button>
      <button data-action="moveDown">Move down</button>
    </div>
    <div class="modal" id="pageModal" style="display: none;">
      <div class="modal-content">
        <div class="modal-title">Edit Target Page</div>
        <input type="number" id="pageInput" min="1" placeholder="Page number" />
        <div class="modal-actions">
          <button id="pageModalCurrent">Current page</button>
          <button id="pageModalCancel">Cancel</button>
          <button id="pageModalOk" class="primary">OK</button>
        </div>
      </div>
    </div>
    <div class="modal" id="settingsModal" style="display: none;">
      <div class="modal-content modal-wide">
        <div class="modal-title">LLM Settings</div>
        <div class="settings-group">
          <label class="settings-label">Provider:</label>
          <select id="settingsProvider">
            <option value="openai">OpenAI</option>
            <option value="ollama">Ollama</option>
          </select>
        </div>
        <div id="openaiSettings">
          <div class="settings-group">
            <label class="settings-label">API Key:</label>
            <input type="password" id="settingsApiKey" placeholder="sk-...">
          </div>
          <div class="settings-group">
            <label class="settings-label">Model:</label>
            <input type="text" id="settingsOpenaiModel" value="gpt-5-mini">
          </div>
        </div>
        <div id="ollamaSettings" style="display: none;">
          <div class="settings-group">
            <label class="settings-label">Port:</label>
            <input type="number" id="settingsOllamaPort" value="11434">
          </div>
          <div class="settings-group">
            <label class="settings-label">Model:</label>
            <input type="text" id="settingsOllamaModel" value="llama3">
          </div>
        </div>
        <div class="modal-actions">
          <button id="settingsCancel">Cancel</button>
          <button id="settingsSave" class="primary">Save</button>
        </div>
      </div>
    </div>
    <div class="modal" id="tocImportModal" style="display: none;">
      <div class="modal-content modal-wide">
        <div class="modal-title">Import Table of Contents</div>
        <div class="import-top-controls">
          <div class="import-field compact-field">
            <label>Provider for this import:</label>
            <select id="tocProviderOverride">
              <option value="openai">OpenAI</option>
              <option value="ollama">Ollama</option>
            </select>
          </div>
          <div id="pdfModeGroup" class="import-field compact-field" style="display: none;">
            <label>PDF extraction mode:</label>
            <select id="tocPdfExtractMode">
              <option value="auto">Auto detect</option>
              <option value="text">Text</option>
              <option value="vision">Vision (images)</option>
            </select>
          </div>
        </div>
        <div class="import-source-group">
          <label class="radio-label">
            <input type="radio" name="tocSource" value="external-pdf" checked>
            Import from external PDF file
          </label>
          <label class="radio-label">
            <input type="radio" name="tocSource" value="external-text">
            Import from external text file
          </label>
          <label class="radio-label">
            <input type="radio" name="tocSource" value="external-json">
            Import from external JSON file
          </label>
          <label class="radio-label">
            <input type="radio" name="tocSource" value="current-pdf">
            Use pages from current PDF
          </label>
        </div>
        <div id="pageRangeGroup" class="import-field" style="display: none;">
          <label>Page range (e.g. 3-5 or 1,3-5,7):</label>
          <input type="text" id="tocPageRange" placeholder="3-5">
        </div>
        <div id="tocImportStatus" class="import-status"></div>
        <div id="tocImportLog" class="import-log" aria-live="polite"></div>
        <div class="modal-actions">
          <button id="tocImportStart" class="primary">Import</button>
          <button id="tocImportExport" disabled>Export JSON</button>
          <button id="tocImportClose">Close</button>
        </div>
      </div>
    </div>
    <script type="module" src="renderer.js"></script>
  </body>
</html>
